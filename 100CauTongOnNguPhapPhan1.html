<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B1 Grammar Quiz - General Review</title>
    <style>
        /* Basic styling for the body */
        body {
            font-family: 'Inter', Arial, sans-serif; /* Using Inter font */
            margin: 0;
            padding: 20px;
            background-color: #f0f2f5; /* Light gray background */
            color: #333;
            display: flex;
            justify-content: center;
            align-items: flex-start; /* Align to top for better content flow */
            min-height: 100vh;
        }

        /* Container for the entire quiz */
        .quiz-container {
            max-width: 650px; /* Slightly wider for better readability */
            width: 100%;
            background-color: #ffffff; /* White background */
            padding: 30px;
            border-radius: 12px; /* More rounded corners */
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08); /* Softer, deeper shadow */
            margin-top: 30px; /* Add some margin from the top */
        }

        /* Styling for each question page */
        .question-page {
            display: none; /* Hidden by default */
            animation: fadeIn 0.5s ease-in-out; /* Fade-in animation */
        }
        .question-page.active {
            display: block; /* Show active page */
        }

        /* Animation for fading in questions */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Information section (e.g., question number, score) */
        .question-info {
            font-size: 0.95em;
            color: #6a737d; /* Slightly darker gray */
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee; /* Subtle separator */
        }

        /* Question text styling */
        .question-text {
            font-size: 1.25em; /* Larger font for question */
            margin-bottom: 25px;
            font-weight: 600; /* Semi-bold */
            line-height: 1.5;
            color: #2c3e50; /* Darker text */
        }

        /* Options container */
        .options {
            margin-bottom: 20px;
        }

        /* Styling for each option label */
        .options label {
            display: block;
            margin-bottom: 12px; /* More space between options */
            cursor: pointer;
            padding: 14px 20px; /* More padding */
            border: 1px solid #dcdcdc; /* Lighter border */
            border-radius: 8px; /* Rounded corners for options */
            transition: all 0.3s ease; /* Smooth transition for all properties */
            background-color: #fcfcfc;
            box-shadow: 0 2px 5px rgba(0,0,0,0.03); /* Very subtle shadow */
            display: flex;
            align-items: center;
        }

        /* Hover effect for options */
        .options label:hover {
            background-color: #e8f0fe; /* Light blue on hover */
            border-color: #a8d4ff; /* Blue border on hover */
            box-shadow: 0 4px 10px rgba(0,0,0,0.05); /* Slightly more prominent shadow */
        }

        /* Styling for radio buttons */
        .options input[type="radio"] {
            margin-right: 15px; /* More space for radio button */
            transform: scale(1.2); /* Slightly larger radio button */
            accent-color: #007bff; /* Accent color for checked radio */
        }

        /* Feedback message styling (correct/incorrect) */
        .feedback {
            margin-top: 15px;
            padding: 10px 15px;
            border-radius: 8px;
            font-weight: 600;
            text-align: center;
            opacity: 0; /* Hidden by default */
            transform: translateY(-10px);
            animation: slideInFadeIn 0.4s forwards; /* Animation for feedback */
        }
        .feedback.correct {
            background-color: #e6ffe6; /* Light green */
            color: #28a745; /* Dark green */
            border: 1px solid #28a745;
        }
        .feedback.incorrect {
            background-color: #ffe6e6; /* Light red */
            color: #dc3545; /* Dark red */
            border: 1px solid #dc3545;
        }

        /* Animation for feedback message */
        @keyframes slideInFadeIn {
            to { opacity: 1; transform: translateY(0); }
        }

        /* Translation section styling */
        .translation-section {
            margin-top: 25px;
            padding-top: 20px;
            border-top: 1px dashed #e0e0e0; /* Dashed line separator */
            display: none; /* Hidden by default */
            animation: fadeIn 0.5s ease-in-out;
        }

        .translation-section label {
            display: block;
            font-weight: 600;
            margin-bottom: 10px;
            color: #2c3e50;
            font-size: 1.1em;
        }

        .translation-section textarea {
            width: calc(100% - 22px); /* Adjust for padding and border */
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 6px;
            font-size: 1em;
            min-height: 60px;
            resize: vertical; /* Allow vertical resizing */
            margin-bottom: 15px;
        }

        /* Check Translation button */
        .translation-section .check-translation-btn {
            background-color: #17a2b8; /* Teal color */
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.95em;
            font-weight: 500;
            transition: background-color 0.3s ease;
            margin-bottom: 15px;
        }

        .translation-section .check-translation-btn:hover:not(:disabled) {
            background-color: #138496; /* Darker teal on hover */
        }

        .translation-section .check-translation-btn:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }


        .translation-section .correct-translation {
            margin-top: 15px;
            padding: 12px;
            background-color: #e8f0fe; /* Light blue background */
            border: 1px solid #a8d4ff;
            border-radius: 8px;
            font-weight: 500;
            color: #0056b3; /* Darker blue text */
            font-size: 1em;
            line-height: 1.4;
            display: none; /* Hidden by default, will be shown after checking translation */
        }

        /* Button container */
        .buttons {
            margin-top: 30px;
            display: flex;
            justify-content: space-between;
            gap: 15px; /* Space between buttons */
            flex-wrap: wrap; /* Allow buttons to wrap on smaller screens */
        }

        /* Common button styling */
        .buttons button {
            padding: 12px 22px; /* Generous padding */
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.05em;
            font-weight: 500;
            transition: all 0.3s ease;
            flex-grow: 1; /* Allow buttons to grow and fill space */
            min-width: 120px; /* Minimum width for buttons */
        }

        /* Check Answer button styling */
        .buttons .check-btn {
            background-color: #007bff; /* Blue */
            color: white;
            box-shadow: 0 4px 10px rgba(0, 123, 255, 0.2);
        }
        .buttons .check-btn:hover:not(:disabled) {
            background-color: #0056b3; /* Darker blue on hover */
            box-shadow: 0 6px 15px rgba(0, 123, 255, 0.3);
        }
        .buttons .check-btn:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
            box-shadow: none;
        }

        /* Navigation button styling */
        .buttons .nav-btn {
            background-color: #6c757d; /* Gray */
            color: white;
            box-shadow: 0 4px 10px rgba(108, 117, 125, 0.2);
        }
        .buttons .nav-btn:hover:not(:disabled) {
            background-color: #5a6268; /* Darker gray on hover */
            box-shadow: 0 6px 15px rgba(108, 117, 125, 0.3);
        }
        .buttons .nav-btn:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
            box-shadow: none;
        }

        /* Results page styling */
        #results-page {
            text-align: center;
            display: none; /* Hidden by default */
            margin-top: 30px;
            animation: fadeIn 0.5s ease-in-out;
        }
        #results-page h2 {
            color: #007bff;
            margin-bottom: 15px;
            font-size: 2em;
            font-weight: 700;
        }
        #results-page p {
            font-size: 1.3em;
            margin-bottom: 30px;
            color: #4a4a4a;
        }

        /* Restart button styling */
        #restart-btn {
            background-color: #28a745; /* Green */
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.15em;
            font-weight: 600;
            transition: background-color 0.3s ease, box-shadow 0.3s ease;
            box-shadow: 0 4px 10px rgba(40, 167, 69, 0.2);
        }
        #restart-btn:hover {
            background-color: #218838; /* Darker green on hover */
            box-shadow: 0 6px 15px rgba(40, 167, 69, 0.3);
        }

        /* History section styling */
        #quiz-history {
            margin-top: 40px;
            border-top: 1px solid #eee;
            padding-top: 20px;
        }

        #quiz-history h3 {
            font-size: 1.5em;
            color: #007bff;
            margin-bottom: 15px;
        }

        #history-list {
            list-style: none;
            padding: 0;
            max-height: 250px; /* Limit height and add scroll */
            overflow-y: auto;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            background-color: #fdfdfd;
        }

        #history-list li {
            padding: 12px 15px;
            border-bottom: 1px dashed #f0f0f0;
            text-align: left;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        #history-list li:last-child {
            border-bottom: none;
        }

        #history-list li span {
            font-size: 0.95em;
            color: #555;
        }

        #history-list li .score-entry {
            font-weight: 600;
            color: #2c3e50;
        }


        /* Responsive adjustments */
        @media (max-width: 500px) {
            .quiz-container {
                padding: 20px;
                margin-top: 15px;
            }
            .question-text {
                font-size: 1.1em;
            }
            .options label {
                padding: 12px 15px;
            }
            .buttons button {
                width: 100%; /* Full width buttons on small screens */
                min-width: unset;
                flex-grow: unset;
            }
            .translation-section textarea {
                width: calc(100% - 20px); /* Adjust for padding only */
            }
        }
    </style>
</head>
<body>

    <div class="quiz-container">
        <div id="quiz-pages">
            <!-- Questions will be dynamically injected here by JavaScript -->
        </div>

        <div id="results-page">
            <h2>Quiz Completed!</h2>
            <p>You scored <span id="final-score">0</span> out of <span id="total-questions">0</span>.</p>
            <button id="restart-btn">Restart Quiz</button>

            <div id="quiz-history">
                <h3>Lịch sử làm bài:</h3>
                <ul id="history-list">
                    <!-- History items will be dynamically injected here -->
                </ul>
            </div>
        </div>
    </div>

    <script>
        // Array containing all quiz questions, options, and correct answers
        const questions = [
            {
                question: "Discover our ________________ - gentle on your gums and the environment.",
                options: ["A. bamboo eco-friendly toothbrush", "B. bamboo toothbrush eco-friendly", "C. eco-friendly bamboo toothbrush", "D. eco-friendly toothbrush bamboo"],
                answer: "C",
                translation: "Hãy khám phá bàn chải đánh răng thân thiện với môi trường làm từ tre của chúng tôi - nhẹ nhàng cho nướu và thân thiện với môi trường."
            },
            {
                question: "For families on the go, this travel system, ______________ stroller and car seat functions, will ensure safety.",
                options: ["A. to combine", "B. combined", "C. combines", "D. combining"],
                answer: "D",
                translation: "Đối với các gia đình thường xuyên di chuyển, hệ thống du lịch này, kết hợp chức năng xe đẩy và ghế ô tô, sẽ đảm bảo an toàn."
            },
            {
                question: "Customers are ______________ by the improved formula, now delivering even faster results.",
                options: ["A. amazing", "B. amaze", "C. amazed", "D. amazingly"],
                answer: "C",
                translation: "Khách hàng rất ngạc nhiên bởi công thức cải tiến, hiện mang lại kết quả nhanh hơn nữa."
            },
            {
                question: "______________ product comes with a two-year warranty, ensuring you get lasting quality.",
                options: ["A. Other", "B. Each", "C. Many", "D. A few"],
                answer: "B",
                translation: "Mỗi sản phẩm đều đi kèm với bảo hành hai năm, đảm bảo bạn có được chất lượng bền vững."
            },
            {
                question: "You can control the ______________ of light entering the room with our adjustable window blinds.",
                options: ["A. scale", "B. quality", "C. number", "D. amount"],
                answer: "D",
                translation: "Bạn có thể kiểm soát lượng ánh sáng đi vào phòng bằng rèm cửa sổ điều chỉnh được của chúng tôi."
            },
            {
                question: "Have you considered ______________ an online course to boost your qualifications?",
                options: ["A. taking", "B. take", "C. to take", "D. to taking"],
                answer: "A",
                translation: "Bạn đã cân nhắc tham gia một khóa học trực tuyến để nâng cao trình độ chưa?"
            },
            {
                question: "This ______________ provides ultimate comfort on long flights or road trips.",
                options: ["A. travel pillow innovative", "B. innovative travel pillow", "C. travel innovative pillow", "D. innovative pillow travel"],
                answer: "B",
                translation: "Chiếc gối du lịch sáng tạo này mang lại sự thoải mái tối đa trong các chuyến bay dài hoặc chuyến đi đường dài."
            },
            {
                question: "You'll find comfort in our new sandals, ______________ with soft memory foam and flexible support.",
                options: ["A. crafting", "B. crafted", "C. to craft", "D. which craft"],
                answer: "B",
                translation: "Bạn sẽ tìm thấy sự thoải mái trong những đôi sandal mới của chúng tôi, được chế tác với lớp mút hoạt tính mềm mại và hỗ trợ linh hoạt."
            },
            {
                question: "Discover our herbal tea, perfect for creating a ______________ evening after a long, stressful day.",
                options: ["A. relaxing", "B. relax", "C. relaxation", "D. relaxed"],
                answer: "A",
                translation: "Khám phá trà thảo mộc của chúng tôi, hoàn hảo để tạo ra một buổi tối thư giãn sau một ngày dài căng thẳng."
            },
            {
                question: "Try ______________ flavor from our new ice cream range, which delights your taste buds every time.",
                options: ["A. others", "B. the other", "C. another", "D. other"],
                answer: "C",
                translation: "Hãy thử một hương vị khác từ dòng kem mới của chúng tôi, sẽ làm hài lòng vị giác của bạn mỗi lần."
            },
            {
                question: "We offer a wide ______________ of workshops throughout the year to help you improve your skills.",
                options: ["A. amount", "B. variety", "C. number", "D. capacity"],
                answer: "B",
                translation: "Chúng tôi cung cấp nhiều loại hội thảo trong suốt cả năm để giúp bạn cải thiện kỹ năng của mình."
            },
            {
                question: "Our flexible policies allow customers ______________ their reservations without penalty.",
                options: ["A. to change", "B. change", "C. to changing", "D. changing"],
                answer: "A",
                translation: "Các chính sách linh hoạt của chúng tôi cho phép khách hàng thay đổi đặt chỗ mà không bị phạt."
            },
            {
                question: "Take advantage of our ______________ and save big on all appliances!",
                options: ["A. limited summer offer", "B. limited offer summer", "C. summer offer limited", "D. summer limited offer"],
                answer: "A",
                translation: "Hãy tận dụng ưu đãi mùa hè có hạn của chúng tôi và tiết kiệm lớn cho tất cả các thiết bị!"
            },
            {
                question: "Our compact blender, ______________ by a high-torque motor, blends smoothies in just 30 seconds.",
                options: ["A. powering", "B. to power", "C. power", "D. powered"],
                answer: "D",
                translation: "Máy xay sinh tố nhỏ gọn của chúng tôi, được cung cấp năng lượng bởi động cơ mô-men xoắn cao, xay sinh tố chỉ trong 30 giây."
            },
            {
                question: "Enjoy a workout experience with our new fitness app, designed to keep you ______________.",
                options: ["A. motivating", "B. motivated", "C. motivation", "D. motivate"],
                answer: "B",
                translation: "Tận hưởng trải nghiệm tập luyện với ứng dụng thể dục mới của chúng tôi, được thiết kế để giữ cho bạn có động lực."
            },
            {
                question: "______________ customers trust our brand for its quality, affordability, and good customer service.",
                options: ["A. Little", "B. Another", "C. Many", "D. Every"],
                answer: "C",
                translation: "Nhiều khách hàng tin tưởng thương hiệu của chúng tôi vì chất lượng, giá cả phải chăng và dịch vụ khách hàng tốt."
            },
            {
                question: "We guarantee the exact ______________ of coffee beans in each pack to maintain consistent flavor and aroma.",
                options: ["A. quantity", "B. degree", "C. extent", "D. amount"],
                answer: "A",
                translation: "Chúng tôi đảm bảo số lượng hạt cà phê chính xác trong mỗi gói để duy trì hương vị và mùi thơm nhất quán."
            },
            {
                question: "Now you can afford ______________ the world without breaking your budget, thanks to our savings bundles.",
                options: ["A. to travel", "B. travel", "C. to traveling", "D. traveling"],
                answer: "A",
                translation: "Bây giờ bạn có thể đủ khả năng đi khắp thế giới mà không vượt quá ngân sách của mình, nhờ các gói tiết kiệm của chúng tôi."
            },
            {
                question: "Protect your home with our ______________ - easy to use and install.",
                options: ["A. alarm smart system", "B. smart alarm system", "C. smart system alarm", "D. alarm system smart"],
                answer: "B",
                translation: "Bảo vệ ngôi nhà của bạn bằng hệ thống báo động thông minh của chúng tôi - dễ sử dụng và cài đặt."
            },
            {
                question: "Our delicious bubble tea, ______________ from Taiwan, offers a fun and refreshing twist that will delight your taste buds!",
                options: ["A. originated", "B. originating", "C. to originate", "D. is originated"],
                answer: "B",
                translation: "Trà sữa trân châu thơm ngon của chúng tôi, có nguồn gốc từ Đài Loan, mang đến một sự thay đổi thú vị và sảng khoái sẽ làm hài lòng vị giác của bạn!"
            },
            {
                question: "Our sunscreen offers long-lasting ______________ keeping your skin safe even under strong tropical sunlight.",
                options: ["A. protection", "B. protected", "C. protect", "D. protective"],
                answer: "A",
                translation: "Kem chống nắng của chúng tôi mang lại khả năng bảo vệ lâu dài giúp giữ cho làn da của bạn an toàn ngay cả dưới ánh nắng mặt trời nhiệt đới mạnh mẽ."
            },
            {
                question: "______________ lucky customers will win exclusive prizes when they join our loyalty program today.",
                options: ["A. A few", "B. A little", "C. A couple", "D. A lot"],
                answer: "A",
                translation: "Một vài khách hàng may mắn sẽ giành được những giải thưởng độc quyền khi họ tham gia chương trình khách hàng thân thiết của chúng tôi ngay hôm nay."
            },
            {
                question: "Enjoy a competitive interest ______________ when you open a savings account with us today.",
                options: ["A. quality", "B. degree", "C. rate", "D. variety"],
                answer: "C",
                translation: "Tận hưởng lãi suất cạnh tranh khi bạn mở tài khoản tiết kiệm với chúng tôi ngay hôm nay."
            },
            {
                question: "You can avoid ______________ time in traffic by using our route planner with real-time updates.",
                options: ["A. waste", "B. wasting", "C. to waste", "D. to wasting"],
                answer: "B",
                translation: "Bạn có thể tránh lãng phí thời gian trong giao thông bằng cách sử dụng công cụ lập kế hoạch tuyến đường của chúng tôi với các cập nhật theo thời gian thực."
            },
            {
                question: "Don't miss our ______________, up to 50% off selected items!",
                options: ["A. winter sale exclusive", "B. winter exclusive sale", "C. exclusive sale winter", "D. exclusive winter sale"],
                answer: "D",
                translation: "Đừng bỏ lỡ chương trình giảm giá mùa đông độc quyền của chúng tôi, giảm giá tới 50% cho các mặt hàng được chọn!"
            },
            {
                question: "Our new tablet, ______________ built-in study tools, boosts focus and organization.",
                options: ["A. to offer", "B. offers", "C. offered", "D. offering"],
                answer: "D",
                translation: "Máy tính bảng mới của chúng tôi, cung cấp các công cụ học tập tích hợp, giúp tăng cường sự tập trung và tổ chức."
            },
            {
                question: "Say goodbye to ______________ delays with our delivery system, bringing your orders on time.",
                options: ["A. frustrate", "B. frustrating", "C. frustrated", "D. frustratingly"],
                answer: "B",
                translation: "Nói lời tạm biệt với những chậm trễ gây khó chịu với hệ thống giao hàng của chúng tôi, mang đến đơn hàng của bạn đúng giờ."
            },
            {
                question: "______________ designs in our new collection are perfect for casual outings and formal events alike.",
                options: ["A. Another", "B. Much", "C. Each", "D. Some"],
                answer: "D",
                translation: "Một số thiết kế trong bộ sưu tập mới của chúng tôi hoàn hảo cho cả những buổi đi chơi bình thường và các sự kiện trang trọng."
            },
            {
                question: "The noise ______________ in our soundproof rooms is always kept to a minimum for a peaceful environment.",
                options: ["A. basis", "B. level", "C. number", "D. scale"],
                answer: "B",
                translation: "Mức độ tiếng ồn trong các phòng cách âm của chúng tôi luôn được giữ ở mức tối thiểu để có một môi trường yên tĩnh."
            },
            {
                question: "New parents often struggle ______________ safe, reliable childcare - we're here to change that.",
                options: ["A. find", "B. to finding", "C. finding", "D. to find"],
                answer: "D",
                translation: "Các bậc cha mẹ mới thường gặp khó khăn trong việc tìm kiếm dịch vụ chăm sóc trẻ em an toàn, đáng tin cậy - chúng tôi ở đây để thay đổi điều đó."
            },
            {
                question: "Our ______________ removes 99.9% of contaminants without affecting the natural taste of your drinking water.",
                options: ["A. advanced filter water", "B. water filter advanced", "C. advanced water filter", "D. water advanced filter"],
                answer: "C",
                translation: "Bộ lọc nước tiên tiến của chúng tôi loại bỏ 99.9% chất gây ô nhiễm mà không ảnh hưởng đến hương vị tự nhiên của nước uống của bạn."
            },
            {
                question: "A sleek watch, ______________ heart rate and sleep patterns, helps you understand your health better every day.",
                options: ["A. which track", "B. tracked", "C. tracking", "D. to track"],
                answer: "C",
                translation: "Một chiếc đồng hồ kiểu dáng đẹp, theo dõi nhịp tim và kiểu ngủ, giúp bạn hiểu rõ hơn về sức khỏe của mình mỗi ngày."
            },
            {
                question: "Our clients feel ______________ thanks to our team of dedicated mental health professionals.",
                options: ["A. encouragement", "B. encouraging", "C. encourage", "D. encouraged"],
                answer: "D",
                translation: "Khách hàng của chúng tôi cảm thấy được khuyến khích nhờ đội ngũ chuyên gia sức khỏe tâm thần tận tâm của chúng tôi."
            },
            {
                question: "______________ local artists contributed to the unique decorations featured in our boutique hotel.",
                options: ["A. Every", "B. Several", "C. Much", "D. Another"],
                answer: "B",
                translation: "Một số nghệ sĩ địa phương đã đóng góp vào các đồ trang trí độc đáo được trưng bày trong khách sạn boutique của chúng tôi."
            },
            {
                question: "Our diet provides a balanced ______________ of proteins, fats, and carbohydrates in every meal.",
                options: ["A. scale", "B. amount", "C. proportion", "D. capacity"],
                answer: "C",
                translation: "Chế độ ăn uống của chúng tôi cung cấp một tỷ lệ cân bằng protein, chất béo và carbohydrate trong mỗi bữa ăn."
            },
            {
                question: "Students tend ______________ better after using our learning tools tailored to individual needs.",
                options: ["A. to perform", "B. perform", "C. performing", "D. to performing"],
                answer: "A",
                translation: "Học sinh có xu hướng học tốt hơn sau khi sử dụng các công cụ học tập của chúng tôi được điều chỉnh theo nhu cầu cá nhân."
            },
            {
                question: "Designed for daily use, our ______________ fits comfortably and distributes weight evenly.",
                options: ["A. travel ultra-light backpack", "B. ultra-light travel backpack", "C. travel backpack ultra-light", "D. ultra-light backpack travel"],
                answer: "B",
                translation: "Được thiết kế để sử dụng hàng ngày, ba lô du lịch siêu nhẹ của chúng tôi vừa vặn thoải mái và phân bổ trọng lượng đều."
            },
            {
                question: "Discover the full program, ______________ live classes and recorded sessions, by scanning the QR code below.",
                options: ["A. which include", "B. including", "C. included", "D. to include"],
                answer: "B",
                translation: "Khám phá chương trình đầy đủ, bao gồm các lớp học trực tiếp và các buổi học được ghi lại, bằng cách quét mã QR bên dưới."
            },
            {
                question: "Discover ______________ learning materials for children aged 3-6, perfect for keeping young minds engaged.",
                options: ["A. exciting", "B. excite", "C. excited", "D. excitedly"],
                answer: "C",
                translation: "Khám phá các tài liệu học tập thú vị dành cho trẻ em từ 3-6 tuổi, hoàn hảo để giữ cho tâm trí trẻ luôn hứng thú."
            },
            {
                question: "______________ species plays a vital role in maintaining the balance of our ecosystem, contributing to the rich diversity of life on our planet.",
                options: ["A. Other", "B. Much", "C. Each", "D. Some"],
                answer: "C",
                translation: "Mỗi loài đóng một vai trò quan trọng trong việc duy trì sự cân bằng của hệ sinh thái của chúng ta, góp phần vào sự đa dạng phong phú của sự sống trên hành tinh của chúng ta."
            },
            {
                question: "This venue has a seating ______________ of nearly 300, ideal for conferences, weddings, and large gatherings.",
                options: ["A. amount", "B. capacity", "C. degree", "D. level"],
                answer: "B",
                translation: "Địa điểm này có sức chứa gần 300 chỗ ngồi, lý tưởng cho các hội nghị, đám cưới và các cuộc tụ họp lớn."
            },
            {
                question: "Customers want ______________ more than just a product - they seek connection and purpose.",
                options: ["A. experience", "B. to experience", "C. experiencing", "D. to experiencing"],
                answer: "B",
                translation: "Khách hàng muốn trải nghiệm nhiều hơn là chỉ một sản phẩm - họ tìm kiếm sự kết nối và mục đích."
            },
            {
                question: "Thanks to its ______________, the stroller feels light but stays strong even on uneven ground.",
                options: ["A. sleek aluminum frame", "B. aluminum sleek frame", "C. sleek frame aluminum", "D. aluminum frame sleek"],
                answer: "A",
                translation: "Nhờ khung nhôm bóng bẩy, xe đẩy cảm thấy nhẹ nhưng vẫn chắc chắn ngay cả trên địa hình không bằng phẳng."
            },
            {
                question: "Our clock, ______________ both time and temperature, adds function and style to any room.",
                options: ["A. showing", "B. to show", "C. showed", "D. is showed"],
                answer: "A",
                translation: "Đồng hồ của chúng tôi, hiển thị cả thời gian và nhiệt độ, bổ sung chức năng và phong cách cho bất kỳ căn phòng nào."
            },
            {
                question: "We use certified organic ingredients, offering an ______________ solution for those with sensitive skin.",
                options: ["A. effect", "B. effective", "C. affect", "D. effectively"],
                answer: "B",
                translation: "Chúng tôi sử dụng các thành phần hữu cơ được chứng nhận, cung cấp một giải pháp hiệu quả cho những người có làn da nhạy cảm."
            },
            {
                question: "There isn't ______________ difference between the models, but our experts can help you decide.",
                options: ["A. few", "B. every", "C. much", "D. another"],
                answer: "C",
                translation: "Không có nhiều sự khác biệt giữa các mẫu, nhưng các chuyên gia của chúng tôi có thể giúp bạn quyết định."
            },
            {
                question: "Our training sessions are held on a weekly ______________ to ensure continuous skill development for participants.",
                options: ["A. basis", "B. scale", "C. degree", "D. amount"],
                answer: "A",
                translation: "Các buổi đào tạo của chúng tôi được tổ chức hàng tuần để đảm bảo phát triển kỹ năng liên tục cho người tham gia."
            },
            {
                question: "Our experts suggest you ______________ customer reviews before choosing a package that best suits your needs.",
                options: ["A. to read", "B. read", "C. reading", "D. to reading"],
                answer: "B",
                translation: "Các chuyên gia của chúng tôi khuyên bạn nên đọc các đánh giá của khách hàng trước khi chọn một gói phù hợp nhất với nhu cầu của bạn."
            },
            {
                question: "A ______________ will be tailored to your unique skin type and daily lifestyle needs.",
                options: ["A. customized routine skincare", "B. customized skincare routine", "C. skincare customized routine", "D. skincare routine customized"],
                answer: "B",
                translation: "Một liệu trình chăm sóc da tùy chỉnh sẽ được điều chỉnh theo loại da độc đáo và nhu cầu lối sống hàng ngày của bạn."
            },
            {
                question: "This water bottle keeps your drink cool for hours, ______________ you stay hydrated throughout the day.",
                options: ["A. helps", "B. helping", "C. to help", "D. helped"],
                answer: "B",
                translation: "Bình nước này giữ cho đồ uống của bạn mát trong nhiều giờ, giúp bạn giữ nước suốt cả ngày."
            }
        ];

        // Global variables to manage quiz state
        let currentQuestionIndex = 0; // Tracks the current question being displayed
        let score = 0; // Stores the user's score
        // quizAnswers stores the user's selected answer for each question (e.g., 'C' for question 0)
        let quizAnswers = new Array(questions.length).fill(null);
        // quizFeedback stores whether the user's answer was 'correct' or 'incorrect' for each question
        let quizFeedback = new Array(questions.length).fill(null);
        // userTranslations stores the user's input for translation for each question
        let userTranslations = new Array(questions.length).fill(''); // Initialize with empty strings
        // translationChecked stores whether the user has clicked "Sample translation" for a question
        let translationChecked = new Array(questions.length).fill(false);


        // Get references to DOM elements
        const quizPagesContainer = document.getElementById('quiz-pages');
        const resultsPage = document.getElementById('results-page');
        const finalScoreSpan = document.getElementById('final-score');
        const totalQuestionsSpan = document.getElementById('total-questions');
        const restartBtn = document.getElementById('restart-btn');
        const historyList = document.getElementById('history-list'); // Reference to the history list UL

        /**
         * Initializes or restarts the quiz.
         * Resets score, current question index, and clears previous answers/feedback.
         * Renders all questions and displays the first one.
         */
        function initializeQuiz() {
            quizPagesContainer.innerHTML = ''; // Clear any existing question elements
            score = 0; // Reset score
            currentQuestionIndex = 0; // Go back to the first question
            quizAnswers = new Array(questions.length).fill(null); // Clear all user answers
            quizFeedback = new Array(questions.length).fill(null); // Clear all feedback
            userTranslations = new Array(questions.length).fill(''); // Clear all user translations
            translationChecked = new Array(questions.length).fill(false); // Reset translation check status
            totalQuestionsSpan.textContent = questions.length; // Display total questions
            renderQuestions(); // Create the HTML for all questions
            showQuestion(currentQuestionIndex); // Show the first question
            resultsPage.style.display = 'none'; // Hide the results page
            quizPagesContainer.style.display = 'block'; // Ensure quiz pages are visible
        }

        /**
         * Renders (creates the HTML for) all questions.
         * Each question gets its own 'question-page' div.
         */
        function renderQuestions() {
            questions.forEach((q, index) => {
                const questionPage = document.createElement('div');
                questionPage.classList.add('question-page');
                questionPage.id = `question-page-${index}`; // Unique ID for each question page

                // Construct the HTML for the question, options, feedback, and navigation buttons
                questionPage.innerHTML = `
                    <div class="question-info">
                        <span>Câu ${index + 1}/${questions.length}</span>
                        <span>Điểm: <span id="score-${index}">${quizFeedback[index] === 'correct' ? 1 : 0}</span></span>
                    </div>
                    <div class="question-text">${q.question}</div>
                    <div class="options" id="options-${index}">
                        ${q.options.map((option, optIndex) => `
                            <label>
                                <input type="radio" name="question-${index}" value="${option.charAt(0)}"
                                    ${quizAnswers[index] === option.charAt(0) ? 'checked' : ''}
                                    onchange="enableCheckButton(${index})">
                                ${option}
                            </label>
                        `).join('')}
                    </div>
                    <div class="feedback" id="feedback-${index}"></div>

                    <!-- New Translation Section -->
                    <div class="translation-section" id="translation-section-${index}">
                        <label for="translation-input-${index}">Your Vietnamese Translation:</label>
                        <textarea id="translation-input-${index}" oninput="storeTranslation(${index});">${userTranslations[index]}</textarea>
                        <button class="check-translation-btn" id="check-translation-btn-${index}" onclick="showCorrectTranslation(${index})" disabled>Sample Translation</button>
                        <div class="correct-translation" id="correct-translation-${index}" style="display: none;">
                            ${q.translation}
                        </div>
                    </div>

                    <div class="buttons">
                        <button class="nav-btn prev-btn" onclick="prevQuestion()" ${index === 0 ? 'disabled' : ''}>Previous</button>
                        <button class="check-btn" id="check-btn-${index}" onclick="checkAnswer(${index})">Check Answer</button>
                        <button class="nav-btn next-btn" onclick="nextQuestion()">Next</button>
                    </div>
                `;
                quizPagesContainer.appendChild(questionPage); // Add the question page to the container

                // Update score display if the question was already answered correctly during a restart
                if (quizFeedback[index] === 'correct') {
                    document.getElementById(`score-${index}`).textContent = '1';
                }
            });
        }

        /**
         * Displays a specific question page and hides all others.
         * @param {number} index - The index of the question to display.
         */
        function showQuestion(index) {
            // Hide all question pages
            document.querySelectorAll('.question-page').forEach((page) => {
                page.classList.remove('active');
            });

            // Show the requested question page
            const targetPage = document.getElementById(`question-page-${index}`);
            if (targetPage) {
                targetPage.classList.add('active');
            }

            currentQuestionIndex = index; // Update the current question index
            updateNavigationButtons(); // Enable/disable Prev/Next buttons based on current index
            updateCheckButtonState(index); // Update check button state (enabled/disabled)
            updateFeedbackDisplay(index); // Show/hide feedback based on if question was answered
            updateOptionsEnabledState(index); // Enable/disable options based on if question was answered
            updateTranslationDisplay(index); // Show/hide translation section and load user's previous translation
            updateTranslationCheckButtonState(index); // Ensure translation button state is correct when showing question
        }

        /**
         * Updates the disabled state of the "Previous" and "Next" navigation buttons.
         */
        function updateNavigationButtons() {
            const currentPage = document.getElementById(`question-page-${currentQuestionIndex}`);
            if (!currentPage) return;

            const prevBtn = currentPage.querySelector('.prev-btn');
            const nextBtn = currentPage.querySelector('.next-btn');

            if (prevBtn) {
                prevBtn.disabled = currentQuestionIndex === 0;
            }

            if (nextBtn) {
                if (currentQuestionIndex === questions.length - 1) {
                    nextBtn.textContent = 'Finish Quiz';
                    nextBtn.disabled = false; // Ensure it's enabled for the last question to allow finishing.
                } else {
                    nextBtn.textContent = 'Next';
                    nextBtn.disabled = false; // Always enabled for 'Next'
                }
            }
        }

        /**
         * Updates the disabled state of the "Check Answer" button for a given question.
         * It is disabled if no option is selected or if the question has been answered correctly.
         * @param {number} index - The index of the question.
         */
        function updateCheckButtonState(index) {
            const checkBtn = document.getElementById(`check-btn-${index}`);
            const selectedOption = document.querySelector(`input[name="question-${index}"]:checked`);

            if (checkBtn) {
                // Check button is disabled if the question was answered correctly OR if no option is selected
                checkBtn.disabled = (quizFeedback[index] === 'correct') || !selectedOption;
            }
        }

        /**
         * Enables the "Check Answer" button for a question when an option is selected.
         * This is called by the `onchange` event of the radio buttons.
         * @param {number} index - The index of the question.
         */
        function enableCheckButton(index) {
            const checkBtn = document.getElementById(`check-btn-${index}`);
            // Only enable if the question hasn't been answered correctly yet
            if (checkBtn && quizFeedback[index] !== 'correct') {
                checkBtn.disabled = false;
            }
        }

        /**
         * Updates the display of feedback messages for a given question.
         * @param {number} index - The index of the question.
         */
        function updateFeedbackDisplay(index) {
            const feedbackDiv = document.getElementById(`feedback-${index}`);
            if (feedbackDiv) {
                if (quizFeedback[index] === 'correct') {
                    feedbackDiv.textContent = "Correct!";
                    feedbackDiv.classList.remove('incorrect');
                    feedbackDiv.classList.add('correct');
                    feedbackDiv.style.opacity = 1;
                    feedbackDiv.style.transform = 'translateY(0)';
                } else if (quizFeedback[index] === 'incorrect') {
                    feedbackDiv.textContent = `Sai rồi. Vui lòng thử lại.`; // Do not show correct answer here
                    feedbackDiv.classList.remove('correct');
                    feedbackDiv.classList.add('incorrect');
                    feedbackDiv.style.opacity = 1;
                    feedbackDiv.style.transform = 'translateY(0)';
                } else {
                    feedbackDiv.textContent = '';
                    feedbackDiv.classList.remove('correct', 'incorrect');
                    feedbackDiv.style.opacity = 0;
                    feedbackDiv.style.transform = 'translateY(-10px)';
                }
            }
        }

        /**
         * Updates the enabled/disabled state of options for a given question.
         * Options are disabled only if the question has been answered correctly.
         * @param {number} index - The index of the question.
         */
        function updateOptionsEnabledState(index) {
            const optionsDiv = document.getElementById(`options-${index}`);
            if (optionsDiv) {
                const radios = optionsDiv.querySelectorAll('input[type="radio"]');
                const questionAnsweredCorrectly = quizFeedback[index] === 'correct';

                radios.forEach(radio => {
                    radio.disabled = questionAnsweredCorrectly;
                });
            }
        }


        /**
         * Checks the user's selected answer for a given question against the correct answer.
         * Updates score, displays feedback, and disables options/check button.
         * Also displays the translation section.
         * @param {number} index - The index of the question to check.
         */
        function checkAnswer(index) {
            const selectedOption = document.querySelector(`input[name="question-${index}"]:checked`);
            const feedbackDiv = document.getElementById(`feedback-${index}`);
            const scoreSpan = document.getElementById(`score-${index}`);
            const checkBtn = document.getElementById(`check-btn-${index}`);
            const optionsDiv = document.getElementById(`options-${index}`);
            const translationSection = document.getElementById(`translation-section-${index}`);

            // If no option is selected, show a message and do nothing else
            if (!selectedOption) {
                feedbackDiv.textContent = "Please select an answer to check.";
                feedbackDiv.classList.remove('correct', 'incorrect');
                feedbackDiv.style.opacity = 1; // Ensure feedback is visible
                feedbackDiv.style.transform = 'translateY(0)';
                return;
            }

            const userAnswer = selectedOption.value;

            if (userAnswer === questions[index].answer) {
                feedbackDiv.textContent = "Correct!";
                feedbackDiv.classList.remove('incorrect');
                feedbackDiv.classList.add('correct');
                if (quizFeedback[index] !== 'correct') { // Prevent double counting score if re-checking
                    score++;
                    quizFeedback[index] = 'correct'; // Mark as correct
                }
                scoreSpan.textContent = '1'; // Display score for this question as 1

                checkBtn.disabled = true; // Disable check button after checking
                // Disable all radio buttons for this question after checking to prevent changes
                optionsDiv.querySelectorAll('input[type="radio"]').forEach(radio => {
                    radio.disabled = true;
                });

                // Show the translation section after checking the answer
                if (translationSection) {
                    translationSection.style.display = 'block';
                    updateTranslationCheckButtonState(index); // Update state for translation check button
                }

            } else {
                feedbackDiv.textContent = `Sai rồi. Vui lòng thử lại.`; // Incorrect message, no correct answer revealed
                feedbackDiv.classList.remove('correct');
                feedbackDiv.classList.add('incorrect');
                if (quizFeedback[index] === 'correct') { // If previously correct and now wrong (shouldn't happen with disabled options but for robustness)
                    score--;
                }
                quizFeedback[index] = 'incorrect'; // Mark as incorrect
                scoreSpan.textContent = '0'; // Display score for this question as 0

                checkBtn.disabled = false; // Keep check button enabled for re-selection
                // Keep radio buttons enabled for re-selection
                optionsDiv.querySelectorAll('input[type="radio"]').forEach(radio => {
                    radio.disabled = false;
                    // Uncheck the incorrect option to encourage re-selection (optional, but good UX)
                    if(radio.value === userAnswer) {
                        radio.checked = false;
                    }
                });

                // Keep translation section hidden if answer is incorrect
                if (translationSection) {
                    translationSection.style.display = 'none';
                }
            }

            // Trigger animation for feedback display
            feedbackDiv.style.opacity = 1;
            feedbackDiv.style.transform = 'translateY(0)';
        }

        /**
         * Stores the user's translation input for a given question.
         * @param {number} index - The index of the question.
         */
        function storeTranslation(index) {
            const translationInput = document.getElementById(`translation-input-${index}`);
            if (translationInput) {
                userTranslations[index] = translationInput.value;
                updateTranslationCheckButtonState(index); // Update button state whenever input changes
            }
        }

        /**
         * Updates the disabled state of the "Sample Translation" button.
         * It is enabled only if the translation input has text and the sample translation hasn't been shown yet.
         * @param {number} index - The index of the question.
         */
        function updateTranslationCheckButtonState(index) {
            const checkTranslationBtn = document.getElementById(`check-translation-btn-${index}`);
            const translationInput = document.getElementById(`translation-input-${index}`);
            if (checkTranslationBtn && translationInput) {
                // Button is enabled if there's text in the textarea AND the translation hasn't been shown yet.
                checkTranslationBtn.disabled = translationInput.value.trim() === '' || translationChecked[index];
            }
        }

        /**
         * Shows the correct translation for the current question.
         * @param {number} index - The index of the question.
         */
        function showCorrectTranslation(index) {
            const correctTranslationDiv = document.getElementById(`correct-translation-${index}`);
            const checkTranslationBtn = document.getElementById(`check-translation-btn-${index}`);
            const translationInput = document.getElementById(`translation-input-${index}`);

            if (correctTranslationDiv) {
                correctTranslationDiv.style.display = 'block'; // Show the correct translation
                translationChecked[index] = true; // Mark that translation has been checked
                if (checkTranslationBtn) {
                    checkTranslationBtn.disabled = true; // Disable the button after showing
                }
                if (translationInput) {
                    translationInput.disabled = true; // Disable textarea after showing sample translation
                }
            }
        }

        /**
         * Updates the visibility and content of the translation section when a question is shown.
         * @param {number} index - The index of the question.
         */
        function updateTranslationDisplay(index) {
            const translationSection = document.getElementById(`translation-section-${index}`);
            const translationInput = document.getElementById(`translation-input-${index}`);
            const correctTranslationDiv = document.getElementById(`correct-translation-${index}`);
            const checkTranslationBtn = document.getElementById(`check-translation-btn-${index}`);

            if (translationSection) {
                // Only show the translation section if the question has been answered correctly
                if (quizFeedback[index] === 'correct') {
                    translationSection.style.display = 'block';
                } else {
                    translationSection.style.display = 'none';
                }
            }

            // Load user's previous translation if available
            if (translationInput) {
                translationInput.value = userTranslations[index];
                // Disable textarea if sample translation has been shown
                translationInput.disabled = translationChecked[index];
            }

            // Show/hide correct translation and update button state
            if (correctTranslationDiv) {
                correctTranslationDiv.style.display = translationChecked[index] ? 'block' : 'none';
            }
            updateTranslationCheckButtonState(index); // Re-evaluate button state based on stored data
        }


        /**
         * Navigates to the previous question.
         */
        function prevQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                showQuestion(currentQuestionIndex);
            }
        }

        /**
         * Navigates to the next question or displays the results if it's the last question.
         */
        function nextQuestion() {
            if (currentQuestionIndex < questions.length - 1) {
                currentQuestionIndex++;
                showQuestion(currentQuestionIndex);
            } else {
                // If it's the last question and 'Finish Quiz' is clicked
                displayResults();
            }
        }

        /**
         * Displays the final results page.
         */
        function displayResults() {
            quizPagesContainer.style.display = 'none'; // Hide quiz questions
            resultsPage.style.display = 'block'; // Show results page
            finalScoreSpan.textContent = score; // Update final score

            // Save current quiz result to history
            const now = new Date();
            const formattedDate = now.toLocaleDateString('vi-VN', {
                year: 'numeric', month: '2-digit', day: '2-digit',
                hour: '2-digit', minute: '2-digit'
            });
            const newResult = {
                score: score,
                total: questions.length,
                date: formattedDate
            };

            let quizHistory = JSON.parse(localStorage.getItem('quizHistory') || '[]');
            quizHistory.push(newResult);
            localStorage.setItem('quizHistory', JSON.stringify(quizHistory));

            // Display history
            renderQuizHistory();
        }

        /**
         * Renders the quiz history from local storage.
         */
        function renderQuizHistory() {
            historyList.innerHTML = ''; // Clear existing history entries
            let quizHistory = JSON.parse(localStorage.getItem('quizHistory') || '[]');

            if (quizHistory.length === 0) {
                const noHistoryItem = document.createElement('li');
                noHistoryItem.textContent = 'Chưa có lịch sử làm bài.';
                historyList.appendChild(noHistoryItem);
                return;
            }

            // Display most recent entries first
            quizHistory.slice().reverse().forEach((entry, index) => {
                const listItem = document.createElement('li');
                listItem.innerHTML = `
                    <span>${entry.date}</span>
                    <span class="score-entry">Đúng: ${entry.score}/${entry.total}</span>
                `;
                historyList.appendChild(listItem);
            });
        }

        // Event Listeners for initial load and restart button
        window.onload = initializeQuiz;
        restartBtn.onclick = initializeQuiz;
    </script>
</body>
</html>
